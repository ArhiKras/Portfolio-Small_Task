import time

def introduction():
    print("Добро пожаловать в подземелье! Ты отважился войти в тёмные глубины, где могут произойти ужасные вещи.")
    time.sleep(1)
    print("\nТвоя задача — дойти до конца подземелья, преодолевая препятствия на своём пути.\n")
    time.sleep(1)
    print("Выбирай свои действия осторожно, и помни, что каждое решение влияет на твоё приключение!")

def make_choice(question, options):
    print(question)
    for i, option in enumerate(options, start=1):
        print(f"{i}. {option}")

    while True:
        try:
            choice = int(input("Выбери номер действия: "))
            if 1 <= choice <= len(options):
                return choice
            else:
                print(f"Пожалуйста, введите число от 1 до {len(options)}")
        except ValueError:
            print("Пожалуйста, введите число.")

def dungeon_quest():
    introduction()
    inventory = []

    # Задание 1
    print("\nЗадание 1: Ты стоишь перед развилкой.")
    choice_1 = make_choice("Куда идти?", ["Продолжить влево", "Вернуться назад"])

    if choice_1 == 1:
        print("\nТы идёшь влево и видишь дверь.")
        choice_2 = make_choice("Что будешь делать?", ["Открыть дверь", "Вернуться назад"])

        if choice_2 == 1:
            print("\nТы входишь в следующую комнату и находишь ключ.")
            inventory.append("Ключ от двери")
        else:
            print("\nТы решаешь вернуться к развилке.")
    else:
        print("\nТы решаешь не рисковать и возвращаешься назад.")

    # Задание 2
    print("\nЗадание 2: Перед тобой мост через бездну.")
    choice_3 = make_choice("Твои действия?", ["Перейти осторожно", "Вернуться обратно"])

    if choice_3 == 1:
        print("\nТы успешно переходишь мост.")
    else:
        print("\nТы решаешь вернуться обратно.")

    # Задание 3
    print("\nЗадание 3: Ты видишь сундук.")
    choice_4 = make_choice("Открыть его?", ["Открыть сундук", "Пройти мимо"])

    if choice_4 == 1:
        print("\nТы открываешь сундук и находишь меч!")
        inventory.append("Меч")
    else:
        print("\nТы решаешь не рисковать и проходишь мимо.")

    # Задание 4
    print("\nЗадание 4: Ты стоишь перед последней дверью.")

    if "Ключ от двери" in inventory and "Меч" in inventory:
        choice_5 = make_choice("Какое решение примешь?", ["Использовать ключ", "Попробовать взломать дверь мечом"])

        if choice_5 == 1:
            print("\nТы открываешь дверь ключом и выбираешься из подземелья. Поздравляю, ты победил!")
            print("\nИтог: Ты прошёл подземелье и нашёл все сокровища!")
        else:
            print("\nТы пытаешься взломать дверь мечом, но она не поддаётся.")
            choice_6 = make_choice("Хочешь использовать ключ?", ["Да, использовать ключ", "Нет, продолжать ломать дверь"])

            if choice_6 == 1:
                print("\nТы открываешь дверь ключом и выбираешься из подземелья. Поздравляю, ты победил!")
                print("\nИтог: Ты прошёл подземелье и нашёл все сокровища!")
            else:
                print("\nТы упорно пытаешься сломать дверь, но безрезультатно. Тебе не удаётся выбраться.")
                print("\nИтог: Ты застрял в подземелье.")

    elif "Ключ от двери" in inventory:
        choice_5 = make_choice("Использовать ключ?", ["Использовать ключ", "Попробовать открыть дверь без ключа"])

        if choice_5 == 1:
            print("\nТы открываешь дверь ключом и выбираешься из подземелья.")
            print("\nИтог: Ты выбрался, но не нашёл меч.")
        else:
            print("\nДверь не поддаётся. Тебе не хватает силы, чтобы открыть её без меча.")
            print("\nИтог: Ты застрял в подземелье.")

    elif "Меч" in inventory:
        choice_5 = make_choice("Попробовать взломать дверь мечом?", ["Попробовать взломать дверь", "Искать другой выход"])

        if choice_5 == 1:
            print("\nТы пытаешься взломать дверь мечом, но она не поддаётся. Тебе не хватает ключа.")
            print("\nИтог: Ты застрял в подземелье.")
        else:
            print("\nТы ищешь другой выход, но не находишь его.")
            print("\nИтог: Ты застрял в подземелье.")

    else:
        print("\nДверь не поддаётся. У тебя нет ни ключа, ни меча.")
        print("\nИтог: Ты застрял в подземелье.")

if __name__ == "__main__":
    dungeon_quest()